const bundles: Record<string, Record<string, string | string[]>> = {
  en: {
    hub_book_btn: "Book",
    hub_my_visits_btn: "My visits",
    tab_booking: "Booking",
    tab_visits: "My visits",
    hero_title: "Book without chats or calls",
    hero_sub: "Choose a service, master and time — we'll send confirmation to the bot.",
    continue: "Continue",
    next: "Next",
    confirm: "Confirm",
    close: "Close",
    booking_preview: "Booking Preview",
    booking_label: "Booking",
    service_label: "Service:",
    master_label: "Master:",
    date_label: "Date:",
    duration_label: "Duration:",
    to_be_paid: "To be paid:",
    paid_label: "Paid",
    online_discount: "Online payment discount:",
    hold_countdown: "Slot held —",
    payment_unavailable_version: "Payment is not available in this version of Telegram.",
    payment_cancelled: "Payment cancelled by user.",
    payment_failed: "Payment failed. Please try again.",
    awaiting_payment: "Awaiting payment confirmation…",
    payment_success: "Payment succeeded.",
    unavailable_days_note: "Unavailable days are disabled per bot data.",
    choose_payment_method: "Choose a payment method",
    slot_taken: "Someone just booked this slot, please pick another.",
    booking_failed: "Failed to create booking. Try another slot.",
    network_unavailable: "Network unavailable. Try again.",
    choose_master: "Please choose a master",
    heading_service: "Choose a service",
    heading_master: "Who will serve you",
    heading_date: "When convenient",
    heading_time_prefix: "Time on",
    heading_confirm: "Check details",
    heading_done: "Done",
    no_masters: "No masters for selected services.",
    no_slots: "No available slots. Try another day.",
    slot_reserved: "Slot temporarily reserved",
    reserve_failed: "Failed to reserve slot. Try again.",
    hold_expired: "Hold expired. Refreshing slots.",
    press_confirm: 'Press "Confirm" below to submit booking.',
    pay_label: "Payment",
    cash: "Cash",
    cash_sub: "Pay at visit",
    online: "Online",
    online_sub: "Bank card",
    month_names: [
      "January","February","March","April","May","June","July","August","September","October","November","December"
    ],
    dow_short: ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
    my_visits_title: "My visits",
    my_visits_sub: "Active and completed bookings in two tabs.",
    tab_upcoming: "Upcoming",
    tab_history: "History",
    no_upcoming: "No upcoming bookings.",
    no_history: "No completed bookings yet.",
    details_title: "Booking details",
    details_sub: "Below are booking details. Use buttons to change or cancel.",
    reschedule_title: "Reschedule visit",
    reschedule_sub: "Choose new date and time. The bot will check availability.",
    reschedule_free: "No payment required",
    reschedule_confirm_hint: "Press the main button to confirm the new time.",
    label_new_datetime: "New date and time",
    cancel_btn: "Cancel booking",
    save_btn: "Save",
    close_btn: "Close",
    cancel_failed: "Failed to cancel booking",
    reschedule_failed: "Failed to reschedule booking",
    rate_failed: "Failed to save rating",
    book_with_master: "Select",
    master_profile: "Profile of master",
    cancel_label: "Cancel",
    reschedule_label: "Reschedule",
    repeat_label: "Book again",
    rating_label_prefix: "Rating",
    status_pending: "Pending",
    status_booked: "Booked",
    status_confirmed: "Confirmed",
    status_done: "Done",
    status_cancelled: "Cancelled",
    status_no_show: "No show",
    master_default: "Master",
    service_default: "Service",
    minutes_short: "min",
    hour_one: "hour",
    hour_few: "hours",
    hour_many: "hours",
    minute_one: "minute",
    minute_few: "minutes",
    minute_many: "minutes",
      success_heading: "You're booked!",
      success_my_visits: "My visits",
      success_home: "Back to home",
      success_address_hint: "We are waiting for you at %s",
      reminder_message: "We'll remind you %s before the visit.",
      nearest_visit_label: "Your nearest visit",
      master_orders_label: "Orders",
      master_orders_short: "orders",
      services_label: "Services",
      schedule_label: "Schedule",
  },
  ru: {
    hub_book_btn: "Записаться",
    hub_my_visits_btn: "Мои записи",
    tab_booking: "Запись:",
    tab_visits: "Мои визиты",
    hero_title: "Запись без чатов и звонков",
    hero_sub: "Выберите услугу, мастера и время — мы отправим подтверждение в бот.",
    continue: "Продолжить",
    next: "Далее",
    confirm: "Подтвердить",
    close: "Закрыть",
    booking_preview: "Предпросмотр брони",
    booking_label: "Запись:",
    service_label: "Услуга:",
    master_label: "Мастер:",
    date_label: "Дата:",
    duration_label: "Длительность:",
    to_be_paid: "К оплате:",
    paid_label: "Оплачено",
    online_discount: "Скидка за онлайн-оплату:",
    hold_countdown: "Слот удерживается —",
    payment_unavailable_version: "Оплата недоступна в этой версии Telegram.",
    payment_cancelled: "Оплата отменена пользователем.",
    payment_failed: "Оплата не прошла. Попробуйте ещё раз.",
    awaiting_payment: "Ожидание подтверждения оплаты…",
    payment_success: "Оплата прошла успешно.",
    unavailable_days_note: "Недоступные дни выключены по данным бота.",
    choose_payment_method: "Выберите способ оплаты",
    slot_taken: "Кто-то только что занял этот слот, выберите другой.",
    booking_failed: "Не удалось забронировать. Попробуйте другой слот.",
    network_unavailable: "Сеть недоступна. Попробуйте ещё раз.",
    choose_master: "Пожалуйста, выберите мастера",
    heading_service: "Выберите услугу",
    heading_master: "Кто вас примет",
    heading_date: "Когда удобно",
    heading_time_prefix: "Время на",
    heading_confirm: "Проверьте детали",
    heading_done: "Готово",
    no_masters: "Нет мастеров для выбранных услуг.",
    no_slots: "Свободных слотов нет. Попробуйте другой день.",
    slot_reserved: "Слот временно зарезервирован",
    reserve_failed: "Ошибка резервирования слота. Попробуйте ещё раз.",
    hold_expired: "Время удержания слота истекло. Обновляем слоты.",
    press_confirm: 'Нажмите "Подтвердить" внизу, чтобы отправить бронь.',
    pay_label: "Оплата",
    cash: "Наличными",
    cash_sub: "Оплата при визите",
    online: "Онлайн",
    online_sub: "Банковская карта",
    month_names: [
      "Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"
    ],
    dow_short: ["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],
    my_visits_title: "Мои визиты",
    my_visits_sub: "Активные и завершённые записи в двух вкладках.",
    tab_upcoming: "Активные",
    tab_history: "Завершённые",
    no_upcoming: "Нет активных записей.",
    no_history: "Завершённых записей пока нет.",
    details_title: "Детали записи",
    details_sub: "Ниже отображены данные записи. Чтобы изменить время или отменить — используйте кнопки.",
    reschedule_title: "Перенести визит",
    reschedule_sub: "Выберите новую дату и время. Бот проверит возможность переноса.",
    reschedule_free: "Оплата не требуется",
    reschedule_confirm_hint: "Нажмите основную кнопку, чтобы подтвердить новое время.",
    label_new_datetime: "Новая дата и время",
    cancel_btn: "Отменить запись",
    save_btn: "Сохранить",
    close_btn: "Закрыть",
    cancel_failed: "Не удалось отменить запись",
    reschedule_failed: "Не удалось перенести запись",
    rate_failed: "Не удалось сохранить оценку",
    book_with_master: "Выбрать",
    master_profile: "Профиль мастера",
    cancel_label: "Отменить",
    reschedule_label: "Перенести",
    repeat_label: "Записаться снова",
    rating_label_prefix: "Оценка",
    status_pending: "Ожидает",
    status_booked: "Запланировано",
    status_confirmed: "Подтверждено",
    status_done: "Выполнено",
    status_cancelled: "Отменено",
    status_no_show: "Не пришли",
    master_default: "Мастер",
    service_default: "Услуга",
    minutes_short: "мин",
    hour_one: "час",
    hour_few: "часа",
    hour_many: "часов",
    minute_one: "минута",
    minute_few: "минуты",
    minute_many: "минут",
      success_heading: "Вы записаны!",
      success_my_visits: "Мои записи",
      success_home: "На главную",
      success_address_hint: "Мы ждём вас по этому адресу: %s",
      reminder_message: "Мы напомним вам за %s до визита.",
      nearest_visit_label: "Ваш ближайший визит",
        master_orders_label: "Заказов:",
        master_orders_short: "Заказ.",
      services_label: "Услуги",
      schedule_label: "График",
  }
  ,
  uk: {
    hub_book_btn: "Записатися",
    hub_my_visits_btn: "Мої записи",
    tab_booking: "Запис:",
    tab_visits: "Мої візити",
    hero_title: "Запис без чатів та дзвінків",
    hero_sub: "Виберіть послугу, майстра та час — ми надішлемо підтвердження в бот.",
    continue: "Продовжити",
    next: "Далі",
    confirm: "Підтвердити",
    close: "Закрити",
    booking_preview: "Попередній перегляд броні",
    booking_label: "Запис:",
    service_label: "Послуга:",
    master_label: "Майстер:",
    date_label: "Дата:",
    duration_label: "Тривалість:",
    to_be_paid: "До сплати:",
    paid_label: "Сплачено",
    online_discount: "Знижка за онлайн-оплату:",
    hold_countdown: "Слот утримується —",
    payment_unavailable_version: "Оплата недоступна в цій версії Telegram.",
    payment_cancelled: "Оплата скасована користувачем.",
    payment_failed: "Оплата не пройшла. Спробуйте ще раз.",
    awaiting_payment: "Очікування підтвердження оплати…",
    payment_success: "Оплата пройшла успішно.",
    unavailable_days_note: "Недоступні дні відключені за даними бота.",
    choose_payment_method: "Оберіть спосіб оплати",
    slot_taken: "Хтось щойно зайняв цей слот, виберіть інший.",
    booking_failed: "Не вдалося забронювати. Спробуйте інший слот.",
    network_unavailable: "Мережа недоступна. Спробуйте ще раз.",
    choose_master: "Будь ласка, оберіть майстра",
    heading_service: "Оберіть послугу",
    heading_master: "Хто вас прийме",
    heading_date: "Коли зручно",
    heading_time_prefix: "Час на",
    heading_confirm: "Перевірте деталі",
    heading_done: "Готово",
    no_masters: "Немає майстрів для обраних послуг.",
    no_slots: "Вільних слотів немає. Спробуйте інший день.",
    slot_reserved: "Слот тимчасово зарезервовано",
    reserve_failed: "Не вдалося зарезервувати слот. Спробуйте ще раз.",
    hold_expired: "Час утримання слота минув. Оновлюємо слоти.",
    press_confirm: 'Натисніть "Підтвердити" внизу, щоб відправити бронь.',
    pay_label: "Оплата",
    cash: "Готівка",
    cash_sub: "Оплата під час візиту",
    online: "Онлайн",
    online_sub: "Банківська картка",
    month_names: [
      "Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"
    ],
    dow_short: ["Пн","Вт","Ср","Чт","Пт","Сб","Нд"],
    my_visits_title: "Мої візити",
    my_visits_sub: "Активні та завершені записи у двох вкладках.",
    tab_upcoming: "Активні",
    tab_history: "Завершені",
    no_upcoming: "Немає активних записів.",
    no_history: "Завершених записів поки немає.",
    details_title: "Деталі запису",
    details_sub: "Нижче відображені дані запису. Щоб змінити час або скасувати — використовуйте кнопки.",
    reschedule_title: "Перенести візит",
    reschedule_sub: "Виберіть нову дату та час. Бот перевірить можливість переносу.",
    reschedule_free: "Оплата не потрібна",
    reschedule_confirm_hint: "Натисніть основну кнопку, щоб підтвердити новий час.",
    label_new_datetime: "Нова дата та час",
    cancel_btn: "Скасувати запис",
    save_btn: "Зберегти",
    close_btn: "Закрити",
    cancel_failed: "Не вдалося скасувати запис",
    reschedule_failed: "Не вдалося перенести запис",
    rate_failed: "Не вдалося зберегти оцінку",
    book_with_master: "Обрати",
    master_profile: "Профіль майстра",
    cancel_label: "Скасувати",
    reschedule_label: "Перенести",
    repeat_label: "Записатися знову",
    rating_label_prefix: "Оцінка",
    status_pending: "Очікує",
    status_booked: "Заплановано",
    status_confirmed: "Підтверджено",
    status_done: "Виконано",
    status_cancelled: "Скасовано",
    status_no_show: "Не прийшли",
    master_default: "Майстер",
    service_default: "Послуга",
    minutes_short: "хв",
    hour_one: "година",
    hour_few: "години",
    hour_many: "годин",
    minute_one: "хвилина",
    minute_few: "хвилини",
    minute_many: "хвилин",
      success_heading: "Ви записані!",
      success_my_visits: "Мої записи",
      success_home: "На головну",
      success_address_hint: "Ми чекаємо на вас за адресою: %s",
      reminder_message: "Ми нагадаємо вам за %s до візиту.",
      nearest_visit_label: "Ваш найближчий візит",
      master_orders_label: "Замовлень:",
      master_orders_short: "Замовл.",
      services_label: "Послуги",
      schedule_label: "Графік",
  }
};

function detectLang(): string {
  try {
    const win = window as any;
    const v = win && win.__APP_LOCALE ? String(win.__APP_LOCALE) : (navigator && navigator.language) || "ru";
    const lv = v.toLowerCase();
    if (lv.startsWith("en")) return "en";
    if (lv.startsWith("ru")) return "ru";
    if (lv.startsWith("uk") || lv.startsWith("ua") || lv.startsWith("uk-")) return "uk";
    return "en";
  } catch (err) {
    return "ru";
  }
}

export function t(key: string) {
  const lang = detectLang();
  const b = bundles[lang] || bundles.ru;
  return (b as any)[key];
}

export default t;
export { detectLang };
